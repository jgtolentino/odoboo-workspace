<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Extend HR Expense Form -->
    <record id="view_hr_expense_form_extended" model="ir.ui.view">
        <field name="name">hr.expense.form.extended</field>
        <field name="model">hr.expense</field>
        <field name="inherit_id" ref="hr_expense.hr_expense_form"/>
        <field name="arch" type="xml">
            <xpath expr="//sheet" position="inside">
                <separator string="Documentation"/>
                <group>
                    <group>
                        <field name="expense_category_id"/>
                        <field name="knowledge_page_id"/>
                    </group>
                    <group>
                        <field name="total_attachments" readonly="1"/>
                        <field name="approval_date" readonly="1"/>
                    </group>
                </group>
                <field name="approval_notes" placeholder="Add approval notes..."/>
                <separator string="Attachments"/>
                <field name="attachment_ids" widget="many2many"/>
            </xpath>
        </field>
    </record>

    <!-- Extend HR Expense Tree -->
    <record id="view_hr_expense_tree_extended" model="ir.ui.view">
        <field name="name">hr.expense.tree.extended</field>
        <field name="model">hr.expense</field>
        <field name="inherit_id" ref="hr_expense.hr_expense_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//tree" position="inside">
                <field name="expense_category_id"/>
                <field name="total_attachments"/>
            </xpath>
        </field>
    </record>

    <!-- Add Concur integration fields to expense form -->
    <record id="view_hr_expense_form_concur" model="ir.ui.view">
        <field name="name">hr.expense.form.concur</field>
        <field name="model">hr.expense</field>
        <field name="inherit_id" ref="hr_expense.hr_expense_form"/>
        <field name="arch" type="xml">
            <xpath expr="//sheet" position="inside">
                <separator string="Accounting &amp; Mapping"/>
                <group>
                    <group>
                        <field name="cost_center_id" options="{'no_create_edit': True}"/>
                        <field name="gl_account_id"/>
                        <field name="tax_id"/>
                    </group>
                    <group>
                        <field name="project_id"/>
                        <field name="vendor_id"/>
                        <field name="txn_date"/>
                    </group>
                </group>
                <separator string="Amounts"/>
                <group>
                    <group>
                        <field name="fx_rate" readonly="1"/>
                        <field name="amount_net" readonly="1"/>
                    </group>
                    <group>
                        <field name="amount_tax" readonly="1"/>
                        <field name="amount_gross" readonly="1"/>
                    </group>
                </group>
                <separator string="Integration"/>
                <group>
                    <group>
                        <field name="idempotency_key" readonly="1"/>
                        <field name="export_status" readonly="1"/>
                    </group>
                </group>
                <field name="export_payload" widget="json" readonly="1"/>
                <field name="extracted_fields" widget="json" readonly="1"/>
            </xpath>
        </field>
    </record>
</odoo>
